# SQL-скрипты для преобразования данных

1. SQL-скрипт для представления, чтобы в последствии извлекать из него следующие запросы:

- Лучший бомбардир;
- Количество игр игрока за сезон.

```
CREATE VIEW view_players AS (
	SELECT start_season, end_season, first_name, middle_name, last_name, SUM(score) AS score, COUNT(Scores.date_id) AS Games
	FROM Players
	LEFT JOIN Scores
	ON Players.id_player = Scores.player_id 
	LEFT JOIN dates
	ON Scores.date_id = Dates.id_date 
	GROUP BY season, id
);
```

2. SQL-скрипт для представления, чтобы в последствии извлекать из него счёт команды в игре.

```
CREATE VIEW view_games AS (
	SELECT date_of_game AS game, team_name AS team, SUM(score)
	FROM Scores
	LEFT JOIN Teams
	ON Scores.team_id = Teams.id_team
	LEFT JOIN Dates
	ON Scores.date_id = Dates.id_date
	GROUP BY game, team
)
```
